<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced API Response Viewer</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #e0eafc 0%, #a1c4fd 50%, #c2e9fb 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .api-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            overflow: hidden;
        }
        
        .api-header {
            background: rgba(255, 255, 255, 0.95);
            color: #333;
            padding: 20px;
            text-align: center;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .api-header h1 {
            color: #333;
            margin-bottom: 10px;
        }
        
        .api-header p {
            color: #666;
        }
        
        .method-badge {
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
            margin: 0 5px;
        }
        
        .get { background: #28a745; color: white; }
        .post { background: #007bff; color: white; }
        .put { background: #ffc107; color: black; }
        .delete { background: #dc3545; color: white; }
        
        .response-container {
            background: #f8f9fa;
            border-radius: 10px;
            border: 1px solid #e9ecef;
            overflow: hidden;
        }
        
        .response-header {
            background: #e9ecef;
            padding: 15px;
            border-bottom: 1px solid #dee2e6;
            display: flex;
            justify-content: between;
            align-items: center;
        }
        
        .status-code {
            padding: 5px 12px;
            border-radius: 15px;
            font-weight: bold;
            font-size: 0.8rem;
        }
        
        .status-200 { background: #d4edda; color: #155724; }
        .status-404 { background: #f8d7da; color: #721c24; }
        .status-500 { background: #f5c6cb; color: #721c24; }
        
        .json-viewer {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
            max-height: 500px;
            overflow-y: auto;
        }
        
        .json-key { color: #63b3ed; }
        .json-string { color: #68d391; }
        .json-number { color: #f6ad55; }
        .json-boolean { color: #fc8181; }
        .json-null { color: #a0aec0; }
        
        .endpoint-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 10px 0;
            border-left: 4px solid #007bff;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        
        .endpoint-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }
        
        .test-button {
            background: linear-gradient(45deg, #007bff, #0056b3);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .test-button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }
        
        .user-card {
            background: white;
            border-radius: 15px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #28a745;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .pagination-info {
            background: linear-gradient(45deg, #007bff, #0056b3);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <!-- Header -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="api-card">
                    <div class="api-header">
                        <h1><i class="fas fa-code me-3"></i>Enhanced API Explorer</h1>
                        <p class="mb-0">Beautiful API Testing Interface with Visual Response Viewer</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- API Endpoints -->
        <div class="row">
            <div class="col-md-6">
                <div class="api-card p-4">
                    <h4 class="mb-4"><i class="fas fa-rocket text-primary me-2"></i>API Endpoints</h4>
                    
                    <!-- Get All Users -->
                    <div class="endpoint-card">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <div>
                                <span class="method-badge get">GET</span>
                                <strong>/api/v1/users</strong>
                            </div>
                            <button class="btn test-button" onclick="testEndpoint('users', 'GET')">
                                <i class="fas fa-play me-2"></i>Test
                            </button>
                        </div>
                        <p class="text-muted mb-2">Get all users with pagination (10 per page)</p>
                        <small class="text-info">Features: Pagination, Sorting, Filtering</small>
                    </div>

                    <!-- Get User by ID -->
                    <div class="endpoint-card">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <div>
                                <span class="method-badge get">GET</span>
                                <strong>/api/v1/users/{id}</strong>
                            </div>
                            <button class="btn test-button" onclick="testEndpoint('users/1', 'GET')">
                                <i class="fas fa-play me-2"></i>Test
                            </button>
                        </div>
                        <p class="text-muted mb-2">Get specific user by ID</p>
                        <small class="text-info">Features: Individual user details</small>
                    </div>

                    <!-- External API -->
                    <div class="endpoint-card">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <div>
                                <span class="method-badge get">GET</span>
                                <strong>/api/v1/users/external</strong>
                            </div>
                            <button class="btn test-button" onclick="testEndpoint('users/external', 'GET')">
                                <i class="fas fa-play me-2"></i>Test
                            </button>
                        </div>
                        <p class="text-muted mb-2">Get users from external API (JSONPlaceholder)</p>
                        <small class="text-warning">Features: Nested API calls, External integration</small>
                    </div>

                    <!-- Create User -->
                    <div class="endpoint-card">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <div>
                                <span class="method-badge post">POST</span>
                                <strong>/api/v1/users</strong>
                            </div>
                            <button class="btn test-button" onclick="testCreateUser()">
                                <i class="fas fa-plus me-2"></i>Create
                            </button>
                        </div>
                        <p class="text-muted mb-2">Create a new user</p>
                        <small class="text-success">Features: Validation, Transaction management</small>
                    </div>
                </div>
            </div>

            <!-- Response Viewer -->
            <div class="col-md-6">
                <div class="api-card p-4">
                    <h4 class="mb-4"><i class="fas fa-eye text-success me-2"></i>Response Viewer</h4>
                    
                    <div id="response-container" class="response-container">
                        <div class="response-header">
                            <span><i class="fas fa-info-circle me-2"></i>API Response</span>
                            <span id="status-badge" class="status-code status-200" style="display: none;">200 OK</span>
                        </div>
                        
                        <div id="response-content" class="p-4 text-center text-muted">
                            <i class="fas fa-mouse-pointer fa-3x mb-3"></i>
                            <h5>Click any "Test" button to see API response</h5>
                            <p>The response will be displayed here with beautiful formatting</p>
                        </div>
                    </div>

                    <!-- Visual Data Display -->
                    <div id="visual-data" style="display: none;" class="mt-4">
                        <h5><i class="fas fa-table text-primary me-2"></i>Visual Data</h5>
                        <div id="users-display"></div>
                        <div id="pagination-display"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const baseUrl = 'http://localhost:8080/api/v1';
        
        async function testEndpoint(endpoint, method = 'GET') {
            const button = event.target.closest('.test-button');
            const originalHtml = button.innerHTML;
            
            // Show loading state
            button.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Loading...';
            button.disabled = true;
            
            const responseContainer = document.getElementById('response-container');
            const responseContent = document.getElementById('response-content');
            const statusBadge = document.getElementById('status-badge');
            const visualData = document.getElementById('visual-data');
            
            try {
                const response = await fetch(`${baseUrl}/${endpoint}`);
                const data = await response.json();
                
                // Update status badge
                statusBadge.textContent = `${response.status} ${response.statusText}`;
                statusBadge.className = `status-code status-${response.status}`;
                statusBadge.style.display = 'inline-block';
                
                // Display JSON response
                responseContent.innerHTML = `
                    <div class="json-viewer">
                        ${formatJson(data)}
                    </div>
                `;
                
                // Display visual data
                displayVisualData(data, endpoint);
                
            } catch (error) {
                statusBadge.textContent = 'Error';
                statusBadge.className = 'status-code status-500';
                statusBadge.style.display = 'inline-block';
                
                responseContent.innerHTML = `
                    <div class="alert alert-danger">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        <strong>Error:</strong> ${error.message}
                    </div>
                `;
            } finally {
                // Reset button
                button.innerHTML = originalHtml;
                button.disabled = false;
            }
        }
        
        function formatJson(obj, indent = 0) {
            const indentStr = '  '.repeat(indent);
            
            if (obj === null) return '<span class="json-null">null</span>';
            if (typeof obj === 'boolean') return `<span class="json-boolean">${obj}</span>`;
            if (typeof obj === 'number') return `<span class="json-number">${obj}</span>`;
            if (typeof obj === 'string') return `<span class="json-string">"${obj}"</span>`;
            
            if (Array.isArray(obj)) {
                if (obj.length === 0) return '[]';
                const items = obj.map(item => `${indentStr}  ${formatJson(item, indent + 1)}`).join(',\n');
                return `[\n${items}\n${indentStr}]`;
            }
            
            if (typeof obj === 'object') {
                const keys = Object.keys(obj);
                if (keys.length === 0) return '{}';
                const items = keys.map(key => 
                    `${indentStr}  <span class="json-key">"${key}"</span>: ${formatJson(obj[key], indent + 1)}`
                ).join(',\n');
                return `{\n${items}\n${indentStr}}`;
            }
            
            return String(obj);
        }
        
        function displayVisualData(data, endpoint) {
            const visualData = document.getElementById('visual-data');
            const usersDisplay = document.getElementById('users-display');
            const paginationDisplay = document.getElementById('pagination-display');
            
            if (endpoint.includes('users') && data.data && Array.isArray(data.data)) {
                // Display users in cards
                const usersHtml = data.data.map(user => `
                    <div class="user-card">
                        <div class="d-flex justify-content-between align-items-start">
                            <div>
                                <h6 class="mb-1">${user.firstName} ${user.lastName}</h6>
                                <p class="text-muted mb-1">${user.email}</p>
                                <small class="text-info">${user.city || 'No city'}</small>
                            </div>
                            <span class="badge bg-primary">#${user.id}</span>
                        </div>
                    </div>
                `).join('');
                
                usersDisplay.innerHTML = usersHtml;
                
                // Display pagination info
                if (data.totalItems) {
                    paginationDisplay.innerHTML = `
                        <div class="pagination-info">
                            <div class="row text-center">
                                <div class="col-4">
                                    <strong>${data.totalItems}</strong><br>
                                    <small>Total Users</small>
                                </div>
                                <div class="col-4">
                                    <strong>${data.currentPage + 1}</strong><br>
                                    <small>Current Page</small>
                                </div>
                                <div class="col-4">
                                    <strong>${data.totalPages}</strong><br>
                                    <small>Total Pages</small>
                                </div>
                            </div>
                        </div>
                    `;
                }
                
                visualData.style.display = 'block';
            } else if (Array.isArray(data)) {
                // External API users
                const usersHtml = data.slice(0, 5).map(user => `
                    <div class="user-card">
                        <div class="d-flex justify-content-between align-items-start">
                            <div>
                                <h6 class="mb-1">${user.name}</h6>
                                <p class="text-muted mb-1">${user.email}</p>
                                <small class="text-info">${user.address?.city || 'External API'}</small>
                            </div>
                            <span class="badge bg-warning">#${user.id}</span>
                        </div>
                    </div>
                `).join('');
                
                usersDisplay.innerHTML = usersHtml;
                paginationDisplay.innerHTML = `
                    <div class="pagination-info">
                        <div class="text-center">
                            <strong>${data.length}</strong> users from external API<br>
                            <small>JSONPlaceholder Integration</small>
                        </div>
                    </div>
                `;
                
                visualData.style.display = 'block';
            } else {
                visualData.style.display = 'none';
            }
        }
        
        async function testCreateUser() {
            const button = event.target.closest('.test-button');
            const originalHtml = button.innerHTML;
            
            button.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Creating...';
            button.disabled = true;
            
            const sampleUser = {
                firstName: "John",
                lastName: "Doe",
                email: `john.doe.${Date.now()}@example.com`,
                phone: "+1-555-0123",
                city: "New York"
            };
            
            try {
                const response = await fetch(`${baseUrl}/users`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(sampleUser)
                });
                
                const data = await response.json();
                
                const statusBadge = document.getElementById('status-badge');
                statusBadge.textContent = `${response.status} ${response.statusText}`;
                statusBadge.className = `status-code status-${response.status}`;
                statusBadge.style.display = 'inline-block';
                
                const responseContent = document.getElementById('response-content');
                responseContent.innerHTML = `
                    <div class="json-viewer">
                        ${formatJson(data)}
                    </div>
                `;
                
                // Show success message
                const visualData = document.getElementById('visual-data');
                document.getElementById('users-display').innerHTML = `
                    <div class="alert alert-success">
                        <i class="fas fa-check-circle me-2"></i>
                        <strong>User Created Successfully!</strong><br>
                        ID: ${data.id}, Name: ${data.firstName} ${data.lastName}
                    </div>
                `;
                visualData.style.display = 'block';
                
            } catch (error) {
                console.error('Error creating user:', error);
            } finally {
                button.innerHTML = originalHtml;
                button.disabled = false;
            }
        }
    </script>
</body>
</html>